<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*" Name="StackMatch CLI" Language="1033" Version="1.0.0" Manufacturer="StackMatch" UpgradeCode="PUT-UPGRADE-CODE-GUID-HERE">
        <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

        <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
        <MediaTemplate EmbedCab="yes" />

        <UIRef Id="WixUI_InstallDir" />
        <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />

        <InstallExecuteSequence>
            <Show Dialog="FinishedForm" OnExit="success" />
        </InstallExecuteSequence>

        <Feature Id="ProductFeature" Title="StackMatch CLI" Level="1">
            <ComponentGroupRef Id="ProductComponents" />
        </Feature>
    </Product>

    <Fragment>
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
                <Directory Id="INSTALLFOLDER" Name="StackMatch" />
            </Directory>
        </Directory>
    </Fragment>

    <Fragment>
        <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
            <Component Id="ProductComponent" Guid="PUT-COMPONENT-GUID-HERE">
                <File Id="StackMatchExe" Source="$(var.SourceDir)\stackmatch.exe" KeyPath="yes" />
                <Environment Id="Path" Name="PATH" Value="[INSTALLFOLDER]" Permanent="no" Part="last" Action="set" System="yes" />
            </Component>
        </ComponentGroup>
    </Fragment>

    <Fragment>
        <UI>
            <Dialog Id="FinishedForm" Width="370" Height="270" Title="[ProductName] Setup">
                <Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="Finish">
                    <Publish Event="EndDialog" Value="Return" />
                </Control>
                <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes" Text="StackMatch CLI has been successfully installed." />
            </Dialog>
        </UI>
    </Fragment>
</Wix>
